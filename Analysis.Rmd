---
title: "Program Director Interviews"
output:
  html_document:
    df_print: paged
---

Here, we present an analysis of the interviews with program directors, step by step.

load libraries
```{r}
library(GPArotation)
library(lattice)
library(nFactors)
library(psych)
library(dplyr)
library(poLCA)
library(irr)

```


read data for LCA

```{r}
lca.data <- read.table("./Binary_AllCodes_12.txt", header = TRUE)
tocluster <- lca.data[,c(-1)]
```

```{r}
wss <- (nrow(tocluster)-1)*sum(apply(tocluster,2,var))
for (i in 2:12) wss[i] <- sum(kmeans(tocluster, centers=i)$withinss)
plot(1:12, wss, type="b", xlab="Number of Clusters",
  ylab="Within groups sum of squares")
```


```{r}
lca11<- poLCA(cbind(SocietalIssue, StudentChoice, PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp,	LiketoseeStudentD,	NagativeImp)~1, lca.data, nclass=11, nrep = 100, na.rm=FALSE, graphs=T)
```
```{r}
lca11$predclass

#the numbers below indicate the clusters of participants. For example participants Philosophy 4, Romance 4 and Pharmacy 3, have all been placed in the same cluster.
```


#codes clustering
```{r}
codes.data <- t(lca.data)

codes.data <-as.data.frame(codes.data[-1,])
colnames(codes.data)<- c("SE1","SE3","Philosophy2","Philosophy3","Philosophy4","Counselling1","Counselling2","Counselling3","Romance2","Romance3","Romance4","Pharmacy2","Pharmacy3")
```

```{r}
wss <- (nrow(codes.data)-1)*sum(apply(codes.data,2,var))
for (i in 2:37) wss[i] <- sum(kmeans(codes.data, centers=i)$withinss)
plot(1:37, wss, type="b", xlab="Number of Clusters",
  ylab="Within groups sum of squares")
```

Try the LCA for the codes clustering this time

```{r}
lca11codes<- poLCA(cbind(SE1, SE3, Philosophy2, Philosophy3, Philosophy4, Counselling1, Counselling2, Counselling3, Romance2, Romance3, Romance4, Pharmacy2, Pharmacy3)~1, codes.data, nclass=11, nrep = 100, na.rm=FALSE, graphs=T)
```

```{r}
lca11codes$predclass

#the numbers below indicate the high-order clusters of codes. The idea here is to examine whether these high-order clusters have underlying semantics.
```


```{r}
codes.data["code.clusters"] <- lca11codes$predclass
```

END



-------------mahesha-----------------------------------------
below you can transfer the code from test.R. I've tried to adapt some
# Factor Analysis for All codes

This has done for both "All codes" and "DropoutReasons"
question: what do you mean "for both"?
```{r}
#data <- read.delim(file.choose(),header = TRUE)
data <-read.table("./Binary_AllCodes_12.txt", header = TRUE)
#View(data)
```

#CorrelationMatrix
question: these correlations do not take into account statistical significance, right?
```{r}
raqMatrix <- cor(data[2:49])

head(round(raqMatrix, 2))
```



remove negativeIM and liketo see student data
question: Not sure whats going on here? If you un-comment and re-run, it gives an error
```{r}
#data <- select(data,SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)

#raqMatrix <- cor(data)

#head(round(raqMatrix, 2))
```

