lca.data <- read.table("./Binary_AllCodes_12.txt", header = TRUE)
tocluster <- lca.data[,c(-1)]
wss <- (nrow(tocluster)-1)*sum(apply(tocluster,2,var))
for (i in 2:12) wss[i] <- sum(kmeans(tocluster, centers=i)$withinss)
plot(1:12, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
lca11<- poLCA(cbind(SocietalIssue, StudentChoice, PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp,	LiketoseeStudentD,	NagativeImp)~1, lca.data, nclass=11, nrep = 100, na.rm=FALSE, graphs=T)
lca11$predclass
codes.data <- t(lca.data)
codes.data <-as.data.frame(codes.data[-1,])
colnames(codes.data)<- c("SE1","SE3","Philosophy2","Philosophy3","Philosophy4","Counselling1","Counselling2","Counselling3","Romance2","Romance3","Romance4","Pharmacy2","Pharmacy3")
wss <- (nrow(codes.data)-1)*sum(apply(codes.data,2,var))
for (i in 2:37) wss[i] <- sum(kmeans(codes.data, centers=i)$withinss)
plot(1:37, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
#data <- read.delim(file.choose(),header = TRUE)
data <-read.table("./Binary_ALlCodes_Clustering.txt", header = TRUE)
#View(data)
raqMatrix <- cor(data[2:49])
raqMatrix <- cor(data[2:14])
head(round(raqMatrix, 2))
#data <- read.delim(file.choose(),header = TRUE)
data <-read.table("./Freq_AllCodes.txt", header = TRUE)
#View(data)
raqMatrix <- cor(data[2:50])
head(round(raqMatrix, 2))
data <- select(data,SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
data <- select(data, SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
data <- select(data, SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
library(GPArotation)
library(lattice)
library(nFactors)
library(psych)
library(dplyr)
library(poLCA)
library(irr)
install.packages("irr")
library(GPArotation)
library(lattice)
library(nFactors)
library(psych)
library(dplyr)
library(poLCA)
library(irr)
data <- select(data, SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
#data <- read.delim(file.choose(),header = TRUE)
data <-read.table("./Freq_AllCodes.txt", header = TRUE)
#View(data)
raqMatrix <- cor(data[2:50])
head(round(raqMatrix, 2))
data <- select(data, SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
head(round(raqMatrix, 2))
data1 <- data %>% select(SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
data1 <- data %>% select(SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
#data <- read.delim(file.choose(),header = TRUE)
data <-read.delim("./Freq_AllCodes.txt", header = TRUE)
#View(data)
raqMatrix <- cor(data[2:50])
head(round(raqMatrix, 2))
data <- select(data,SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
data1 <- select(data,SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
data1 <- cbind(SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
data <- read.delim(file.choose(),header = TRUE)
raqMatrix <- cor(data[2:49])
head(round(raqMatrix, 2))
data <- select(data,SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
data
raqMatrix <- cor(data)
data <- select(data,SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
data.pca <- prcomp(data)
data.pca <- prcomp(data)
data <- select(data,SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
data <- select(data,SocietalIssue, StudentChoice, PoliticalProblem, NotaHugeLoss, NotMuchImpact, Finishdegree, GetPromotedinCareer, LowCompletion, LowProbabilityinJob, WasteofInvestments, StudenttookSomeonesplace, N_PopularS, NInterest, OTransfer, WSpeciality, E_Workload, FamilyI, FinancialI, HealthP, Psyco_Social, DifficulutCourse, LearningD, Employment, Thesis, Perfectionism, Checkwithteachers, Counseling, ICourses, Inform, Tracking, SupervisorC, Talk, SandCourses, ImroveStudy_SelfM, CurriculumDevelopmnet, GroupDiscussions, CantfigureSP, DifficultConvince, DifficultCont, LecturersLI, NPtakingActions, TooLate, WorkHours, TMIssues, OwnData, DoNotuseSIS, UseSIS, LiketoseeStudentD, PositiveImp, NagativeImp)
data.pca <- prcomp(data)
data <- cbind(data,SocietalIssue, StudentChoice, PoliticalProblem, NotaHugeLoss, NotMuchImpact, Finishdegree, GetPromotedinCareer, LowCompletion, LowProbabilityinJob, WasteofInvestments, StudenttookSomeonesplace, N_PopularS, NInterest, OTransfer, WSpeciality, E_Workload, FamilyI, FinancialI, HealthP, Psyco_Social, DifficulutCourse, LearningD, Employment, Thesis, Perfectionism, Checkwithteachers, Counseling, ICourses, Inform, Tracking, SupervisorC, Talk, SandCourses, ImroveStudy_SelfM, CurriculumDevelopmnet, GroupDiscussions, CantfigureSP, DifficultConvince, DifficultCont, LecturersLI, NPtakingActions, TooLate, WorkHours, TMIssues, OwnData, DoNotuseSIS, UseSIS, LiketoseeStudentD, PositiveImp, NagativeImp)
data <- read.delim(file.choose(),header = TRUE)
View(data)
raqMatrix <- cor(data[2:49])
head(round(raqMatrix, 2))
data <- select(data,SocietalIssue, StudentChoice, PoliticalProblem, NotaHugeLoss, NotMuchImpact, Finishdegree, GetPromotedinCareer, LowCompletion, LowProbabilityinJob, WasteofInvestments, StudenttookSomeonesplace, N_PopularS, NInterest, OTransfer, WSpeciality, E_Workload, FamilyI, FinancialI, HealthP, Psyco_Social, DifficulutCourse, LearningD, Employment, Thesis, Perfectionism, Checkwithteachers, Counseling, ICourses, Inform, Tracking, SupervisorC, Talk, SandCourses, ImroveStudy_SelfM, CurriculumDevelopmnet, GroupDiscussions, CantfigureSP, DifficultConvince, DifficultCont, LecturersLI, NPtakingActions, TooLate, WorkHours, TMIssues, OwnData, DoNotuseSIS, UseSIS, LiketoseeStudentD, PositiveImp, NagativeImp)
data <- select(data, SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
data <- select(data, "SocietalIssue",	"StudentChoice")
data <- dplyr::select(data, "SocietalIssue",	"StudentChoice")
#raqMatrix <- cor(data)
#head(round(raqMatrix, 2))
data <- dplyr::select(data,SocietalIssue, StudentChoice, PoliticalProblem, NotaHugeLoss, NotMuchImpact, Finishdegree, GetPromotedinCareer, LowCompletion, LowProbabilityinJob, WasteofInvestments, StudenttookSomeonesplace, N_PopularS, NInterest, OTransfer, WSpeciality, E_Workload, FamilyI, FinancialI, HealthP, Psyco_Social, DifficulutCourse, LearningD, Employment, Thesis, Perfectionism, Checkwithteachers, Counseling, ICourses, Inform, Tracking, SupervisorC, Talk, SandCourses, ImroveStudy_SelfM, CurriculumDevelopmnet, GroupDiscussions, CantfigureSP, DifficultConvince, DifficultCont, LecturersLI, NPtakingActions, TooLate, WorkHours, TMIssues, OwnData, DoNotuseSIS, UseSIS, LiketoseeStudentD, PositiveImp, NagativeImp)
data <- dplyr::select(data, "SocietalIssue",	"StudentChoice")
data
#raqMatrix <- cor(data)
#head(round(raqMatrix, 2))
#data <- read.delim(file.choose(),header = TRUE)
data <-read.delim("./Freq_AllCodes.txt", header = TRUE)
#View(data)
raqMatrix <- cor(data[2:50])
head(round(raqMatrix, 2))
data <- dplyr::select(data, SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
#raqMatrix <- cor(data)
#head(round(raqMatrix, 2))
data <- dplyr::select(data, SocietalIssue,	StudentChoice,	PoliticalProblem,	NotaHugeLoss,	NotMuchImpact,	Finishdegree,	GetPromotedinCareer,	LowCompletion,	LowProbabilityinJob,	WasteofInvestments,	StudenttookSomeonesplace,	N_PopularS,	NInterest,	OTransfer,	WSpeciality,	E_Workload,	FamilyI,	FinancialI,	HealthP,	Psyco_Social,	DifficulutCourse,	LearningD,	Employment,	Thesis,	Perfectionism,	Checkwithteachers,	Counseling,	ICourses,	Inform,	Tracking,	SupervisorC,	Talk,	SandCourses,	ImroveStudy_SelfM,	CurriculumDevelopmnet,	GroupDiscussions,	CantfigureSP,	DifficultConvince,	DifficultCont,	LecturersLI,	NPtakingActions,	TooLate,	WorkHours,	TMIssues,	OwnData,	UseSIS,	PositiveImp)
raqMatrix <- cor(data)
head(round(raqMatrix, 2))
data.pca <- prcomp(data)
data.pca <- prcomp(data)
data.pca <- prcomp(data)
summary(data.pca)
plot(data.pca)
parallel<-fa.parallel(data, fm='minres', fa='fa')
dataClus <-read.delim("./BinaryNew.txt", header = TRUE)
HC <- dist(dataClus[2:13], method = "euclidean")
hc1 <- hclust(HC, method = "ward.D2" )
plot(hc1, cex = 0.6, labels = dataClus$Code, hang = -1)
plot(hc1, labels = dataClus$Code, cex = 0.6)
rect.hclust(hc1, k = 6, border = 2:5)
lca.data <- read.delim(file.choose(),header = TRUE)
tocluster <- lca.data[,c(-1)]
wss <- (nrow(tocluster)-1)*sum(apply(tocluster,2,var))
for (i in 2:12) wss[i] <- sum(kmeans(tocluster, centers=i)$withinss)
plot(1:12, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
lca11<- poLCA(cbind(SE1,	SE3,	Philosophy2,	Philosophy3,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)~1, lca.data, nclass=11, nrep = 100, na.rm=FALSE, graphs=T)
library(scatterplot3d)
library(MASS)
library(poLCA)
library(xlsx)
library("reshape2")
library("plyr")
library("dplyr")
library("poLCA")
library("ggplot2")
library("ggparallel")
library("igraph")
library("tidyr")
library("knitr")
lca11<- poLCA(cbind(SE1,	SE3,	Philosophy2,	Philosophy3,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)~1, lca.data, nclass=11, nrep = 100, na.rm=FALSE, graphs=T)
lca11$predclass
codes.data["code.clusters"] <- lca11codes$predclass
codes.data["code.clusters"] <- lca11$predclass
#models with different number of groups without covariates:
set.seed(01012)
lc1<-poLCA(f, data=mydata, nclass=1, na.rm = FALSE, nrep=30, maxiter=3000) #Loglinear independence model.
lc2<-poLCA(f, data=mydata, nclass=2, na.rm = FALSE, nrep=30, maxiter=3000)
lc3<-poLCA(f, data=mydata, nclass=3, na.rm = FALSE, nrep=30, maxiter=3000)
lc4<-poLCA(f, data=mydata, nclass=4, na.rm = FALSE, nrep=30, maxiter=3000)
lc5<-poLCA(f, data=mydata, nclass=5, na.rm = FALSE, nrep=30, maxiter=3000)
lc6<-poLCA(f, data=mydata, nclass=6, na.rm = FALSE, nrep=30, maxiter=3000)
lc7<-poLCA(f, data=mydata, nclass=7, na.rm = FALSE, nrep=30, maxiter=3000)
lc8<-poLCA(f, data=mydata, nclass=8, na.rm = FALSE, nrep=30, maxiter=3000)
lc9<-poLCA(f, data=mydata, nclass=9, na.rm = FALSE, nrep=30, maxiter=3000)
lc10<-poLCA(f, data=mydata, nclass=10, na.rm = FALSE, nrep=30, maxiter=3000)
lc11<-poLCA(f, data=mydata, nclass=11, na.rm = FALSE, nrep=30, maxiter=3000)
set.seed(01012)
lc1<-poLCA(f, data=lca11, nclass=1, na.rm = FALSE, nrep=30, maxiter=3000) #Loglinear independence model.
lc2<-poLCA(f, data=lca11, nclass=2, na.rm = FALSE, nrep=30, maxiter=3000)
lc3<-poLCA(f, data=lca11, nclass=3, na.rm = FALSE, nrep=30, maxiter=3000)
lc4<-poLCA(f, data=lca11, nclass=4, na.rm = FALSE, nrep=30, maxiter=3000)
lc5<-poLCA(f, data=lca11, nclass=5, na.rm = FALSE, nrep=30, maxiter=3000)
lc6<-poLCA(f, data=lca11, nclass=6, na.rm = FALSE, nrep=30, maxiter=3000)
lc7<-poLCA(f, data=lca11, nclass=7, na.rm = FALSE, nrep=30, maxiter=3000)
lc8<-poLCA(f, data=lca11, nclass=8, na.rm = FALSE, nrep=30, maxiter=3000)
lc9<-poLCA(f, data=lca11, nclass=9, na.rm = FALSE, nrep=30, maxiter=3000)
lc10<-poLCA(f, data=lca11, nclass=10, na.rm = FALSE, nrep=30, maxiter=3000)
ds <- poLCA(cbind(data,SE1,	SE3,	Philosophy2,	Philosophy3,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)~1, data=dataAC, graphs = TRUE, na.rm = TRUE)
ds <- poLCA(cbind(data,SE1,	SE3,	Philosophy2,	Philosophy3,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)~1, data=lca.data, graphs = TRUE, na.rm = TRUE)
#data <- read.delim(file.choose(),header = TRUE)
dataFA <-read.delim("./Binary_Factor.txt", header = TRUE)
#View(data)
raqMatrix <- cor(dataFA[2:50])
head(round(raqMatrix, 2))
dataFA <- dplyr::select(data, Student_Choice,	Political_Problem,	No_negative_consequences,	FinishingDegreeisgood,	Getpromotedincareer,	LowCompletionRate,	University_Responsibility,	Less_Jobs,	Waste_of_Investments,	Missused_Opportunities,	University_Rankings,	Less_Popular_Specialisations,	Boring_study_path,	Opportunity_to_Transfer,	Wrong_Speciality,	Extreme_Workload,	Family_issues,	Financial_Issues,	Health_Issues,	Psychological_social_Issues,	Hard_Curricular,	Learning_Difficulties,	Less_Support_from_Uni,	Employment,	Thesis,	Student_Supervisor_Relationship,	Perfectionism,	Track_Student_Behaviour,	Counseling,	Academic_support_programs,	Inform_Relevant_People,	Track_Dropouts,	Supervisor_Communication,	Talk_to_Students,	Seminars_and_Courses,	Stuy_and_SelfManagement,	Curriculum_Development,	Group_Discussions,	To_check_courseregistration,	Check_study_results,	Tax_office_data,	Industry_perspectives,	Qualitative_Data,	Previous_Studies,	Admission_Choice,	Reasonfor_Academic_Leaves,	Numberof_studentdropouts,	Admission_Score,	Extracurricular_courses,	credits_Nextsem_Previoussem,	LowGrades_FailedCourses,	Nextsem_Payments,	International_National_Clusters)
dataFA.pca <- prcomp(dataFA)
dataFA <- dplyr::select(data, Student_Choice,	Political_Problem,	No_negative_consequences,	FinishingDegreeisgood,	Getpromotedincareer,	LowCompletionRate,	University_Responsibility,	Less_Jobs,	Waste_of_Investments,	Missused_Opportunities,	University_Rankings,	Less_Popular_Specialisations,	Boring_study_path,	Opportunity_to_Transfer,	Wrong_Speciality,	Extreme_Workload,	Family_issues,	Financial_Issues,	Health_Issues,	Psychological_social_Issues,	Hard_Curricular,	Learning_Difficulties,	Less_Support_from_Uni,	Employment,	Thesis,	Student_Supervisor_Relationship,	Perfectionism,	Track_Student_Behaviour,	Counseling,	Academic_support_programs,	Inform_Relevant_People,	Track_Dropouts,	Supervisor_Communication,	Talk_to_Students,	Seminars_and_Courses,	Stuy_and_SelfManagement,	Curriculum_Development,	Group_Discussions,	To_check_courseregistration,	Check_study_results,	Tax_office_data,	Industry_perspectives,	Qualitative_Data,	Previous_Studies,	Admission_Choice,	Reasonfor_Academic_Leaves,	Numberof_studentdropouts,	Admission_Score,	Extracurricular_courses,	credits_Nextsem_Previoussem,	LowGrades_FailedCourses,	Nextsem_Payments,	International_National_Clusters)
dataFA <- dplyr::select(dataFA, Student_Choice,	Political_Problem,	No_negative_consequences,	FinishingDegreeisgood,	Getpromotedincareer,	LowCompletionRate,	University_Responsibility,	Less_Jobs,	Waste_of_Investments,	Missused_Opportunities,	University_Rankings,	Less_Popular_Specialisations,	Boring_study_path,	Opportunity_to_Transfer,	Wrong_Speciality,	Extreme_Workload,	Family_issues,	Financial_Issues,	Health_Issues,	Psychological_social_Issues,	Hard_Curricular,	Learning_Difficulties,	Less_Support_from_Uni,	Employment,	Thesis,	Student_Supervisor_Relationship,	Perfectionism,	Track_Student_Behaviour,	Counseling,	Academic_support_programs,	Inform_Relevant_People,	Track_Dropouts,	Supervisor_Communication,	Talk_to_Students,	Seminars_and_Courses,	Stuy_and_SelfManagement,	Curriculum_Development,	Group_Discussions,	To_check_courseregistration,	Check_study_results,	Tax_office_data,	Industry_perspectives,	Qualitative_Data,	Previous_Studies,	Admission_Choice,	Reasonfor_Academic_Leaves,	Numberof_studentdropouts,	Admission_Score,	Extracurricular_courses,	credits_Nextsem_Previoussem,	LowGrades_FailedCourses,	Nextsem_Payments,	International_National_Clusters)
dataFA.pca <- prcomp(dataFA)
summary(dataFA.pca)
plot(dataFA.pca)
ev <- eigen(cor(dataFA)) # get eigenvalues
ap <- parallel(subject=nrow(dataFA),var=ncol(dataFA),
rep=100,cent=.05)
library(GPArotation)
library(lattice)
library(nFactors)
library(psych)
library(dplyr)
library(poLCA)
library(irr)
ev <- eigen(cor(dataFA)) # get eigenvalues
ap <- parallel(subject=nrow(dataFA),var=ncol(dataFA),
rep=100,cent=.05)
nS <- nScree(x=ev$values, aparallel=ap$eigen$qevpea)
plotnScree(nS)
parallel<-fa.parallel(data, fm='minres', fa='fa')
parallel<-fa.parallel(dataFA, fm='minres', fa='fa')
fourFA <- fa(dataFA,nfactors = 4,rotate = "oblimin",fm="minres")
print(fourFA)
print(fourFA$loadings,cutoff = 0.3, sort=TRUE)
dataLCA <-read.delim("./BinaryNew.txt",header = TRUE)
ds <- poLCA(cbind(SE1,	SE3,	Philosophy2,	Philosophy3,	Philosophy4,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)~1, data=dataLCA, graphs = TRUE, na.rm = TRUE)
dataLCA <-read.delim("./BinaryNew.txt",header = TRUE)
ds <- poLCA(cbind(SE1,	SE3,	Philosophy2,	Philosophy3,	Philosophy4,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)~1, data=dataLCA, graphs = TRUE, na.rm = TRUE)
lca11<- poLCA(cbind(SE1,	SE3,	Philosophy2,	Philosophy3,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)~1, lca.data, nclass=11, nrep = 100, na.rm=FALSE, graphs=T)
lca11$predclass
set.seed(01012)
lc1<-poLCA(lca11, data=dataLCA, nclass=1, na.rm = FALSE, nrep=30, maxiter=3000) #Loglinear independence model.
mylcadata <- dataLCA %>% dplyr::select(SE1,	SE3,	Philosophy2,	Philosophy3,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)
f<-with(mylcadata, cbind(SE1,	SE3,	Philosophy2,	Philosophy3,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)~1)
set.seed(01012)
lc1<-poLCA(f, data=mylcadata, nclass=1, na.rm = FALSE, nrep=30, maxiter=3000) #Loglinear independence model.
lc2<-poLCA(f, data=mylcadata, nclass=2, na.rm = FALSE, nrep=30, maxiter=3000)
lc3<-poLCA(f, data=mylcadata, nclass=3, na.rm = FALSE, nrep=30, maxiter=3000)
lc4<-poLCA(f, data=mylcadata, nclass=4, na.rm = FALSE, nrep=30, maxiter=3000)
lc5<-poLCA(f, data=mylcadata, nclass=5, na.rm = FALSE, nrep=30, maxiter=3000)
lc6<-poLCA(f, data=mylcadata, nclass=6, na.rm = FALSE, nrep=30, maxiter=3000)
set.seed(01012)
lc1<-poLCA(f, data=mylcadata, nclass=1, na.rm = FALSE, nrep=30, maxiter=3000) #Loglinear independence model.
lc2<-poLCA(f, data=mylcadata, nclass=2, na.rm = FALSE, nrep=30, maxiter=3000)
lc3<-poLCA(f, data=mylcadata, nclass=3, na.rm = FALSE, nrep=30, maxiter=3000)
lc4<-poLCA(f, data=mylcadata, nclass=4, na.rm = FALSE, nrep=30, maxiter=3000)
lc5<-poLCA(f, data=mylcadata, nclass=5, na.rm = FALSE, nrep=30, maxiter=3000)
lc6<-poLCA(f, data=mylcadata, nclass=6, na.rm = FALSE, nrep=30, maxiter=3000)
lc7<-poLCA(f, data=mylcadata, nclass=7, na.rm = FALSE, nrep=30, maxiter=3000)
lc8<-poLCA(f, data=mylcadata, nclass=8, na.rm = FALSE, nrep=30, maxiter=3000)
lc9<-poLCA(f, data=mylcadata, nclass=9, na.rm = FALSE, nrep=30, maxiter=3000)
lc10<-poLCA(f, data=mylcadata, nclass=10, na.rm = FALSE, nrep=30, maxiter=3000)
lc11<-poLCA(f, data=mylcadata, nclass=11, na.rm = FALSE, nrep=30, maxiter=3000)
results[6,2]<-lc6$llik
results <- data.frame(Modell=c("Modell 1"),
log_likelihood=lc1$llik,
df = lc1$resid.df,
BIC=lc1$bic,
ABIC=  (-2*lc1$llik) + ((log((lc1$N + 2)/24)) * lc1$npar),
CAIC = (-2*lc1$llik) + lc1$npar * (1 + log(lc1$N)),
likelihood_ratio=lc1$Gsq)
results$Modell<-as.integer(results$Modell)
results[1,1]<-c("Modell 1")
results[2,1]<-c("Modell 2")
results[3,1]<-c("Modell 3")
results[4,1]<-c("Modell 4")
results[5,1]<-c("Modell 5")
results[6,1]<-c("Modell 6")
results[7,1]<-c("Modell 7")
results[8,1]<-c("Modell 8")
results[9,1]<-c("Modell 9")
results[10,1]<-c("Modell 10")
results[11,1]<-c("Modell 11")
results[2,2]<-lc2$llik
results[3,2]<-lc3$llik
results[4,2]<-lc4$llik
results[5,2]<-lc5$llik
results[6,2]<-lc6$llik
results[7,2]<-lc7$llik
results[8,2]<-lc8$llik
results[9,2]<-lc9$llik
results[10,2]<-lc10$llik
results[11,2]<-lc11$llik
results[2,3]<-lc2$resid.df
results[3,3]<-lc3$resid.df
results[4,3]<-lc4$resid.df
results[5,3]<-lc5$resid.df
results[6,3]<-lc6$resid.df
results[7,3]<-lc7$resid.df
results[8,3]<-lc8$resid.df
results[9,3]<-lc9$resid.df
results[10,3]<-lc10$resid.df
results[11,3]<-lc11$resid.df
results[2,4]<-lc2$bic
results[3,4]<-lc3$bic
results[4,4]<-lc4$bic
results[5,4]<-lc5$bic
results[6,4]<-lc6$bic
results[7,4]<-lc7$bic
results[8,4]<-lc8$bic
results[9,4]<-lc9$bic
results[10,4]<-lc10$bic
results[11,4]<-lc11$bic
results[2,5]<-(-2*lc2$llik) + ((log((lc2$N + 2)/24)) * lc2$npar) #abic
results[3,5]<-(-2*lc3$llik) + ((log((lc3$N + 2)/24)) * lc3$npar)
results[4,5]<-(-2*lc4$llik) + ((log((lc4$N + 2)/24)) * lc4$npar)
results[5,5]<-(-2*lc5$llik) + ((log((lc5$N + 2)/24)) * lc5$npar)
results[6,5]<-(-2*lc6$llik) + ((log((lc6$N + 2)/24)) * lc6$npar)
results[7,5]<-(-2*lc7$llik) + ((log((lc7$N + 2)/24)) * lc7$npar)
results[8,5]<-(-2*lc8$llik) + ((log((lc8$N + 2)/24)) * lc8$npar)
results[9,5]<-(-2*lc9$llik) + ((log((lc9$N + 2)/24)) * lc9$npar)
results[10,5]<-(-2*lc10$llik) + ((log((lc10$N + 2)/24)) * lc10$npar)
results[11,5]<-(-2*lc11$llik) + ((log((lc11$N + 2)/24)) * lc11$npar)
results[2,6]<- (-2*lc2$llik) + lc2$npar * (1 + log(lc2$N)) #caic
results[3,6]<- (-2*lc3$llik) + lc3$npar * (1 + log(lc3$N))
results[4,6]<- (-2*lc4$llik) + lc4$npar * (1 + log(lc4$N))
results[5,6]<- (-2*lc5$llik) + lc5$npar * (1 + log(lc5$N))
results[6,6]<- (-2*lc6$llik) + lc6$npar * (1 + log(lc6$N))
results[7,6]<- (-2*lc7$llik) + lc7$npar * (1 + log(lc7$N))
results[8,6]<- (-2*lc8$llik) + lc8$npar * (1 + log(lc8$N))
results[9,6]<- (-2*lc9$llik) + lc9$npar * (1 + log(lc9$N))
results[10,6]<- (-2*lc10$llik) + lc10$npar * (1 + log(lc10$N))
results[11,6]<- (-2*lc11$llik) + lc11$npar * (1 + log(lc11$N))
results[2,7]<-lc2$Gsq
results[3,7]<-lc3$Gsq
results[4,7]<-lc4$Gsq
results[5,7]<-lc5$Gsq
results[6,7]<-lc6$Gsq
results[7,7]<-lc7$Gsq
results[8,7]<-lc8$Gsq
results[9,7]<-lc9$Gsq
results[10,7]<-lc10$Gsq
results[11,7]<-lc11$Gsq
results
entropy<-function (p) sum(-p*log(p))
results$R2_entropy
results[1,8]<-c("-")
error_prior<-entropy(lc2$P) # class proportions model 2
error_post<-mean(apply(lc2$posterior,1, entropy),na.rm = TRUE)
results[2,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc3$P) # class proportions model 3
error_post<-mean(apply(lc3$posterior,1, entropy),na.rm = TRUE)
results[3,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc4$P) # class proportions model 4
error_post<-mean(apply(lc4$posterior,1, entropy),na.rm = TRUE)
results[4,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc5$P) # class proportions model 5
error_post<-mean(apply(lc5$posterior,1, entropy),na.rm = TRUE)
results[5,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc6$P) # class proportions model 6
error_post<-mean(apply(lc6$posterior,1, entropy),na.rm = TRUE)
results[6,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc7$P) # class proportions model 7
error_post<-mean(apply(lc7$posterior,1, entropy),na.rm = TRUE)
results[7,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc8$P) # class proportions model8
error_post<-mean(apply(lc8$posterior,1, entropy),na.rm = TRUE)
results[8,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc9$P) # class proportions model 9
error_post<-mean(apply(lc9$posterior,1, entropy),na.rm = TRUE)
results[9,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc10$P) # class proportions model 10
error_post<-mean(apply(lc10$posterior,1, entropy),na.rm = TRUE)
results[10,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc11$P) # class proportions model 11
error_post<-mean(apply(lc11$posterior,1, entropy),na.rm = TRUE)
results[11,8]<-round(((error_prior-error_post) / error_prior),3)
colnames(results)<-c("Model","log-likelihood","resid. df","BIC","aBIC","cAIC","likelihood-ratio","Entropy")
lca_results<-results
library(ztable)
ztable::ztable(lca_results)
lca11<- poLCA(cbind(SE1,	SE3,	Philosophy2,	Philosophy3,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)~1, lca.data, nclass=11, nrep = 100, na.rm=FALSE, graphs=T)
use warnings()
lca.data <-read.delim("./BinaryNew.txt",header = TRUE)
lca11<- poLCA(cbind(SE1,	SE3,	Philosophy2,	Philosophy3,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)~1, lca.data, nclass=11, nrep = 100, na.rm=FALSE, graphs=T)
lca11$predclass
mylcadata <- lca.data %>% dplyr::select(SE1,	SE3,	Philosophy2,	Philosophy3,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)
f<-with(mylcadata, cbind(SE1,	SE3,	Philosophy2,	Philosophy3,	Counselling1,	Counselling2,	Counselling3,	Romance2,	Romance3,	Romance4,	Pharmacy2,	Pharmacy3)~1)
set.seed(01012)
lc1<-poLCA(f, data=mylcadata, nclass=1, na.rm = FALSE, nrep=30, maxiter=3000) #Loglinear independence model.
lc2<-poLCA(f, data=mylcadata, nclass=2, na.rm = FALSE, nrep=30, maxiter=3000)
lc3<-poLCA(f, data=mylcadata, nclass=3, na.rm = FALSE, nrep=30, maxiter=3000)
lc4<-poLCA(f, data=mylcadata, nclass=4, na.rm = FALSE, nrep=30, maxiter=3000)
lc5<-poLCA(f, data=mylcadata, nclass=5, na.rm = FALSE, nrep=30, maxiter=3000)
lc6<-poLCA(f, data=mylcadata, nclass=6, na.rm = FALSE, nrep=30, maxiter=3000)
lc7<-poLCA(f, data=mylcadata, nclass=7, na.rm = FALSE, nrep=30, maxiter=3000)
lc8<-poLCA(f, data=mylcadata, nclass=8, na.rm = FALSE, nrep=30, maxiter=3000)
lc9<-poLCA(f, data=mylcadata, nclass=9, na.rm = FALSE, nrep=30, maxiter=3000)
lc10<-poLCA(f, data=mylcadata, nclass=10, na.rm = FALSE, nrep=30, maxiter=3000)
lc11<-poLCA(f, data=mylcadata, nclass=11, na.rm = FALSE, nrep=30, maxiter=3000)
results <- data.frame(Modell=c("Modell 1"),
log_likelihood=lc1$llik,
df = lc1$resid.df,
BIC=lc1$bic,
ABIC=  (-2*lc1$llik) + ((log((lc1$N + 2)/24)) * lc1$npar),
CAIC = (-2*lc1$llik) + lc1$npar * (1 + log(lc1$N)),
likelihood_ratio=lc1$Gsq)
results$Modell<-as.integer(results$Modell)
results[1,1]<-c("Modell 1")
results[2,1]<-c("Modell 2")
results[3,1]<-c("Modell 3")
results[4,1]<-c("Modell 4")
results[5,1]<-c("Modell 5")
results[6,1]<-c("Modell 6")
results[7,1]<-c("Modell 7")
results[8,1]<-c("Modell 8")
results[9,1]<-c("Modell 9")
results[10,1]<-c("Modell 10")
results[11,1]<-c("Modell 11")
results[2,2]<-lc2$llik
results[3,2]<-lc3$llik
results[4,2]<-lc4$llik
results[5,2]<-lc5$llik
results[6,2]<-lc6$llik
results[7,2]<-lc7$llik
results[8,2]<-lc8$llik
results[9,2]<-lc9$llik
results[10,2]<-lc10$llik
results[11,2]<-lc11$llik
results[2,3]<-lc2$resid.df
results[3,3]<-lc3$resid.df
results[4,3]<-lc4$resid.df
results[5,3]<-lc5$resid.df
results[6,3]<-lc6$resid.df
results[7,3]<-lc7$resid.df
results[8,3]<-lc8$resid.df
results[9,3]<-lc9$resid.df
results[10,3]<-lc10$resid.df
results[11,3]<-lc11$resid.df
results[2,4]<-lc2$bic
results[3,4]<-lc3$bic
results[4,4]<-lc4$bic
results[5,4]<-lc5$bic
results[6,4]<-lc6$bic
results[7,4]<-lc7$bic
results[8,4]<-lc8$bic
results[9,4]<-lc9$bic
results[10,4]<-lc10$bic
results[11,4]<-lc11$bic
results[2,5]<-(-2*lc2$llik) + ((log((lc2$N + 2)/24)) * lc2$npar) #abic
results[3,5]<-(-2*lc3$llik) + ((log((lc3$N + 2)/24)) * lc3$npar)
results[4,5]<-(-2*lc4$llik) + ((log((lc4$N + 2)/24)) * lc4$npar)
results[5,5]<-(-2*lc5$llik) + ((log((lc5$N + 2)/24)) * lc5$npar)
results[6,5]<-(-2*lc6$llik) + ((log((lc6$N + 2)/24)) * lc6$npar)
results[7,5]<-(-2*lc7$llik) + ((log((lc7$N + 2)/24)) * lc7$npar)
results[8,5]<-(-2*lc8$llik) + ((log((lc8$N + 2)/24)) * lc8$npar)
results[9,5]<-(-2*lc9$llik) + ((log((lc9$N + 2)/24)) * lc9$npar)
results[10,5]<-(-2*lc10$llik) + ((log((lc10$N + 2)/24)) * lc10$npar)
results[11,5]<-(-2*lc11$llik) + ((log((lc11$N + 2)/24)) * lc11$npar)
results[2,6]<- (-2*lc2$llik) + lc2$npar * (1 + log(lc2$N)) #caic
results[3,6]<- (-2*lc3$llik) + lc3$npar * (1 + log(lc3$N))
results[4,6]<- (-2*lc4$llik) + lc4$npar * (1 + log(lc4$N))
results[5,6]<- (-2*lc5$llik) + lc5$npar * (1 + log(lc5$N))
results[6,6]<- (-2*lc6$llik) + lc6$npar * (1 + log(lc6$N))
results[7,6]<- (-2*lc7$llik) + lc7$npar * (1 + log(lc7$N))
results[8,6]<- (-2*lc8$llik) + lc8$npar * (1 + log(lc8$N))
results[9,6]<- (-2*lc9$llik) + lc9$npar * (1 + log(lc9$N))
results[10,6]<- (-2*lc10$llik) + lc10$npar * (1 + log(lc10$N))
results[11,6]<- (-2*lc11$llik) + lc11$npar * (1 + log(lc11$N))
results[2,7]<-lc2$Gsq
results[3,7]<-lc3$Gsq
results[4,7]<-lc4$Gsq
results[5,7]<-lc5$Gsq
results[6,7]<-lc6$Gsq
results[7,7]<-lc7$Gsq
results[8,7]<-lc8$Gsq
results[9,7]<-lc9$Gsq
results[10,7]<-lc10$Gsq
results[11,7]<-lc11$Gsq
results
entropy<-function (p) sum(-p*log(p))
results$R2_entropy
results[1,8]<-c("-")
error_prior<-entropy(lc2$P) # class proportions model 2
error_post<-mean(apply(lc2$posterior,1, entropy),na.rm = TRUE)
results[2,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc3$P) # class proportions model 3
error_post<-mean(apply(lc3$posterior,1, entropy),na.rm = TRUE)
results[3,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc4$P) # class proportions model 4
error_post<-mean(apply(lc4$posterior,1, entropy),na.rm = TRUE)
results[4,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc5$P) # class proportions model 5
error_post<-mean(apply(lc5$posterior,1, entropy),na.rm = TRUE)
results[5,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc6$P) # class proportions model 6
error_post<-mean(apply(lc6$posterior,1, entropy),na.rm = TRUE)
results[6,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc7$P) # class proportions model 7
error_post<-mean(apply(lc7$posterior,1, entropy),na.rm = TRUE)
results[7,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc8$P) # class proportions model8
error_post<-mean(apply(lc8$posterior,1, entropy),na.rm = TRUE)
results[8,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc9$P) # class proportions model 9
error_post<-mean(apply(lc9$posterior,1, entropy),na.rm = TRUE)
results[9,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc10$P) # class proportions model 10
error_post<-mean(apply(lc10$posterior,1, entropy),na.rm = TRUE)
results[10,8]<-round(((error_prior-error_post) / error_prior),3)
error_prior<-entropy(lc11$P) # class proportions model 11
error_post<-mean(apply(lc11$posterior,1, entropy),na.rm = TRUE)
results[11,8]<-round(((error_prior-error_post) / error_prior),3)
